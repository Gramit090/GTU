// Language translations
const translations = {
    en: {
        // Index page
        'hero.title': 'GTU Students',
        'hero.subtitle': 'Join our community of talented and creative GTU students. Share your selfie and connect with others!',
        'hero.register': 'Register Now',
        'hero.login': 'Login',
        'feature.selfie.title': 'Share Your Selfie',
        'feature.selfie.desc': 'Take a beautiful selfie and showcase your unique style to the GTU community.',
        'feature.connect.title': 'Connect with Others',
        'feature.connect.desc': 'Discover and connect with other talented students from GTU.',
        'feature.likes.title': 'Get Likes',
        'feature.likes.desc': 'Receive likes and appreciation from your fellow students.',
        'feature.chat.title': 'Live Chat',
        'feature.chat.desc': 'Chat with your fellow GTU students, share photos instantly, and support each other anytime.',
        'no.students': 'No students yet',
        'no.results': 'No matching students found',
        'liked.by': 'Liked by:',
        'like': 'like',
        'likes': 'likes',
        'search.placeholder': 'Search by nickname...',
        'back.home': 'Back to Home',
        'gallery.welcome': 'Welcome,',
        'gallery.logout': 'Logout',
        'chat.welcome': 'Welcome,',
        'chat.logout': 'Logout',
        
        // Chat feature
        'chat.title': 'Live Chat',
        'chat.placeholder': 'Type your message...',
        'chat.send': 'Send',
        'chat.upload': 'Upload Photo',
        'chat.uploading': 'Uploading...',
        'chat.upload.success': 'Photo uploaded successfully',
        'chat.upload.error': 'Error uploading photo',
        'chat.typing': 'is typing...',
        'chat.online': 'Online',
        'chat.offline': 'Offline',
        'chat.no.messages': 'No messages yet. Start the conversation!',
        'chat.help': 'Need help? Ask your fellow students!',
        
        // Register page
        'register.title': 'Create Account',
        'register.nickname': 'Nickname',
        'register.nickname.placeholder': 'Enter your nickname',
        'register.password': 'Password',
        'register.password.placeholder': 'Enter your password',
        'register.button': 'Register',
        
        // Login page
        'login.title': 'Login',
        'login.nickname': 'Nickname',
        'login.nickname.placeholder': 'Enter your nickname',
        'login.password': 'Password',
        'login.password.placeholder': 'Enter your password',
        'login.button': 'Login',
        'login.error': 'Invalid nickname or password',
        'login.no.account': 'Don\'t have an account?',
        'login.register': 'Register',
        
        // Selfie page
        'selfie.title': 'Take Your Selfie',
        'selfie.capture': 'Capture',
        'selfie.retake': 'Retake',
        'selfie.save': 'Save',
        'selfie.upload': 'Upload Photo',
        'selfie.upload.placeholder': 'Choose a photo or drag it here',
        'selfie.upload.button': 'Browse Files',
        'selfie.upload.drag': 'or drag and drop',
        'selfie.upload.size': 'Max file size: 5MB',
        'selfie.upload.format': 'Supported formats: JPG, PNG',
        
        // Navigation
        'nav.home': 'Home',
        'nav.gallery': 'Gallery',
        'nav.chat': 'Chat',
        'nav.register': 'Register',
        'nav.login': 'Login'
    },
    ka: {
        // Index page
        'hero.title': 'GTU სტუდენტები',
        'hero.subtitle': 'შეუერთდი ნიჭიერი და კრეატიული GTU სტუდენტების საზოგადოებას. გააზიარე შენი სელფი და დაუკავშირდი სხვებს!',
        'hero.register': 'რეგისტრაცია',
        'hero.login': 'შესვლა',
        'feature.selfie.title': 'გააზიარე შენი სელფი',
        'feature.selfie.desc': 'გადაიღე ლამაზი სელფი და გამოავლინე შენი უნიკალური სტილი GTU საზოგადოებაში.',
        'feature.connect.title': 'დაუკავშირდი სხვებს',
        'feature.connect.desc': 'აღმოაჩინე და დაუკავშირდი სხვა ნიჭიერ სტუდენტებს GTU-დან.',
        'feature.likes.title': 'მიიღე ლაიქები',
        'feature.likes.desc': 'მიიღე ლაიქები და შეფასება შენი კოლეგებისგან.',
        'feature.chat.title': 'ცოცხალი ჩატი',
        'feature.chat.desc': 'დაუკავშირდი შენს GTU კოლეგებს, გააზიარე ფოტოები მყისვე და დაეხმარე ერთმანეთს ნებისმიერ დროს.',
        'no.students': 'ჯერ არ არის სტუდენტები',
        'no.results': 'სტუდენტები ვერ მოიძებნა',
        'liked.by': 'მოეწონა:',
        'like': 'ლაიქი',
        'likes': 'ლაიქი',
        'search.placeholder': 'ძებნა ზედმეტსახელით...',
        'back.home': 'მთავარი გვერდზე დაბრუნება',
        'gallery.welcome': 'მოგესალმებით,',
        'gallery.logout': 'გასვლა',
        'chat.welcome': 'მოგესალმებით,',
        'chat.logout': 'გასვლა',
        
        // Chat feature
        'chat.title': 'ცოცხალი ჩატი',
        'chat.placeholder': 'შეიყვანე შენი შეტყობინება...',
        'chat.send': 'გაგზავნა',
        'chat.upload': 'ფოტოს ატვირთვა',
        'chat.uploading': 'ატვირთვა...',
        'chat.upload.success': 'ფოტო წარმატებით ატვირთულია',
        'chat.upload.error': 'ფოტოს ატვირთვის შეცდომა',
        'chat.typing': 'ბეჭდავს...',
        'chat.online': 'ონლაინ',
        'chat.offline': 'ოფლაინ',
        'chat.no.messages': 'შეტყობინებები არ არის. დაიწყე საუბარი!',
        'chat.help': 'გჭირდება დახმარება? კითხე შენი კოლეგებისგან!',
        
        // Register page
        'register.title': 'ანგარიშის შექმნა',
        'register.nickname': 'ზედმეტსახელი',
        'register.nickname.placeholder': 'შეიყვანე შენი ზედმეტსახელი',
        'register.password': 'პაროლი',
        'register.password.placeholder': 'შეიყვანე შენი პაროლი',
        'register.button': 'რეგისტრაცია',
        
        // Login page
        'login.title': 'შესვლა',
        'login.nickname': 'ზედმეტსახელი',
        'login.nickname.placeholder': 'შეიყვანე შენი ზედმეტსახელი',
        'login.password': 'პაროლი',
        'login.password.placeholder': 'შეიყვანე შენი პაროლი',
        'login.button': 'შესვლა',
        'login.error': 'არასწორი ზედმეტსახელი ან პაროლი',
        'login.no.account': 'არ გაქვს ანგარიში?',
        'login.register': 'რეგისტრაცია',
        
        // Selfie page
        'selfie.title': 'გადაიღე შენი სელფი',
        'selfie.capture': 'გადაღება',
        'selfie.retake': 'ხელახლა',
        'selfie.save': 'შენახვა',
        'selfie.upload': 'ფოტოს ატვირთვა',
        'selfie.upload.placeholder': 'აირჩიე ფოტო ან ჩააგდე აქ',
        'selfie.upload.button': 'ფაილების არჩევა',
        'selfie.upload.drag': 'ან ჩააგდე აქ',
        'selfie.upload.size': 'მაქსიმალური ზომა: 5MB',
        'selfie.upload.format': 'მხარდაჭერილი ფორმატები: JPG, PNG',
        
        // Navigation
        'nav.home': 'მთავარი',
        'nav.gallery': 'გალერეა',
        'nav.chat': 'ჩატი',
        'nav.register': 'რეგისტრაცია',
        'nav.login': 'შესვლა'
    }
};

// Language management
const i18n = {
    currentLang: localStorage.getItem('language') || 'en',

    init() {
        try {
            this.setLanguage(this.currentLang);
            this.updateLanguageSwitcher();
            console.log('Language system initialized successfully');
        } catch (error) {
            console.error('Error initializing language system:', error);
        }
    },

    setLanguage(lang) {
        try {
            if (!translations[lang]) {
                throw new Error(`Language "${lang}" not supported`);
            }
            this.currentLang = lang;
            localStorage.setItem('language', lang);
            document.documentElement.lang = lang;
            this.updateContent();
            console.log(`Language set to ${lang}`);
        } catch (error) {
            console.error('Error setting language:', error);
            // Fallback to English if there's an error
            this.currentLang = 'en';
            this.updateContent();
        }
    },

    updateContent() {
        try {
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[this.currentLang][key]) {
                    element.textContent = translations[this.currentLang][key];
                } else {
                    console.warn(`Translation missing for key: ${key}`);
                }
            });

            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                if (translations[this.currentLang][key]) {
                    element.placeholder = translations[this.currentLang][key];
                } else {
                    console.warn(`Translation missing for placeholder key: ${key}`);
                }
            });
        } catch (error) {
            console.error('Error updating content:', error);
        }
    },

    updateLanguageSwitcher() {
        try {
            const switcher = document.querySelector('.language-switcher');
            if (switcher) {
                switcher.innerHTML = `
                    <button class="language-btn" onclick="i18n.toggleLanguage()">
                        <i class="fas fa-globe"></i>
                        <span>${this.currentLang.toUpperCase()}</span>
                    </button>
                `;
            } else {
                console.warn('Language switcher element not found');
            }
        } catch (error) {
            console.error('Error updating language switcher:', error);
        }
    },

    toggleLanguage() {
        try {
            const newLang = this.currentLang === 'en' ? 'ka' : 'en';
            this.setLanguage(newLang);
            this.updateLanguageSwitcher();
            console.log(`Language toggled to ${newLang}`);
        } catch (error) {
            console.error('Error toggling language:', error);
        }
    }
};

// Initialize language system when DOM is loaded
document.addEventListener('DOMContentLoaded', () => i18n.init()); 